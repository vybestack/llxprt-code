# Default write tool policy
# Priority band: 1.01 (Tier 1 - Default)
# These tools require user confirmation by default

[[rule]]
toolName = "replace"
decision = "ask_user"
priority = 1.01

[[rule]]
toolName = "write_file"
decision = "ask_user"
priority = 1.01

[[rule]]
toolName = "insert_at_line"
decision = "ask_user"
priority = 1.01

[[rule]]
toolName = "delete_line_range"
decision = "ask_user"
priority = 1.01

[[rule]]
toolName = "shell"
decision = "ask_user"
priority = 1.01

[[rule]]
toolName = "memory"
decision = "ask_user"
priority = 1.01

[[rule]]
toolName = "google_web_fetch"
decision = "ask_user"
priority = 1.01

[[rule]]
toolName = "direct_web_fetch"
decision = "ask_user"
priority = 1.01

# Shell commands with dangerous patterns are denied
[[rule]]
toolName = "shell"
argsPattern = "rm\\s+-rf\\s+/"
decision = "deny"
priority = 2.0

[[rule]]
toolName = "shell"
argsPattern = "chmod\\s+777"
decision = "deny"
priority = 2.0

[[rule]]
toolName = "shell"
argsPattern = "dd\\s+if="
decision = "deny"
priority = 2.0

[[rule]]
toolName = "shell"
argsPattern = "mkfs\\."
decision = "deny"
priority = 2.0

[[rule]]
toolName = "shell"
argsPattern = ":(){ :|:& };:"
decision = "deny"
priority = 2.0
