{
  "tmux": {
    "cols": 80,
    "rows": 22,
    "historyLimit": 200000,
    "scrollbackLines": 20000,
    "initialWaitMs": 6000
  },
  "yolo": true,
  "startCommand": [
    "node",
    "scripts/start.js",
    "--profile-load",
    "synthetic",
    "--yolo"
  ],
  "steps": [
    {
      "type": "waitFor",
      "scope": "screen",
      "contains": "Type your message",
      "timeoutMs": 30000
    },

    { "type": "key", "key": "!" },
    {
      "type": "waitFor",
      "scope": "screen",
      "contains": "shell mode enabled",
      "timeoutMs": 10000
    },

    {
      "type": "line",
      "text": "node scripts/oldui-scrollback-load.js --total 400 --interval-ms 100 --prefix PHRASE",
      "submitKeys": ["Enter"]
    },
    {
      "type": "waitFor",
      "scope": "screen",
      "contains": "Shell Command node scripts/oldui-scrollback-load.js --total 400",
      "timeoutMs": 15000
    },

    { "type": "capture", "label": "t00", "scope": "screen" },
    {
      "type": "expectCount",
      "scope": "screen",
      "regex": "esc to cancel,\\n\\s*\\d+s\\)",
      "equals": 0
    },
    { "type": "wait", "ms": 6000 },
    { "type": "capture", "label": "t06", "scope": "screen" },
    {
      "type": "expectCount",
      "scope": "screen",
      "regex": "esc to cancel,\\n\\s*\\d+s\\)",
      "equals": 0
    },
    { "type": "wait", "ms": 6000 },
    { "type": "capture", "label": "t12", "scope": "screen" },
    {
      "type": "expectCount",
      "scope": "screen",
      "regex": "esc to cancel,\\n\\s*\\d+s\\)",
      "equals": 0
    },
    { "type": "wait", "ms": 4000 },
    { "type": "capture", "label": "t16", "scope": "screen" },
    {
      "type": "expectCount",
      "scope": "screen",
      "regex": "esc to cancel,\\n\\s*\\d+s\\)",
      "equals": 0
    },
    { "type": "wait", "ms": 4000 },
    { "type": "capture", "label": "t20", "scope": "screen" },
    {
      "type": "expectCount",
      "scope": "screen",
      "regex": "esc to cancel,\\n\\s*\\d+s\\)",
      "equals": 0
    },
    { "type": "wait", "ms": 12000 },
    { "type": "capture", "label": "t32", "scope": "screen" },
    {
      "type": "expectCount",
      "scope": "screen",
      "regex": "esc to cancel,\\n\\s*\\d+s\\)",
      "equals": 0
    },

    {
      "type": "waitFor",
      "scope": "scrollback",
      "contains": "PHRASE 0400",
      "timeoutMs": 90000
    },
    {
      "type": "waitForNot",
      "scope": "screen",
      "contains": "esc to cancel",
      "timeoutMs": 60000
    },
    { "type": "capture", "label": "done", "scope": "screen" },

    { "type": "key", "key": "!" },
    {
      "type": "waitForNot",
      "scope": "screen",
      "contains": "shell mode enabled",
      "timeoutMs": 10000
    },
    { "type": "line", "text": "/quit", "submitKeys": ["Escape", "Enter"] },
    { "type": "waitForExit", "timeoutMs": 30000 }
  ]
}
