# Batch 17 Audit

## Intent
Apply Batch 17 upstream commits (8da47db1, 7c086fe5, e4226b8a, 4d2a1111, 426d3614). These cover MCP command test type fixes, MCP UI cleanup/reorg, update nag guard, case-insensitive @file suggestions, and auth test reset.

## Claimed Action
PROGRESS.md claims Batch 17 is VERIFIED with all 5 commits already present. It cites: MCP test fixes via vi.importActual, McpStatus.tsx deleted, subcommands list/desc/schema present, update check guarded by disableUpdateNag, @file search lower-casing, and integration test selectedType reset.

## Code Evidence
- Update nag guard: `checkForUpdates(settings)` is called from `packages/cli/src/gemini.tsx:267`, and `checkForUpdates` returns early when `disableUpdateNag` is true in `packages/cli/src/ui/utils/updateCheck.ts:42-47`.
- Case-insensitive @file suggestions: pattern lowercasing in `packages/cli/src/ui/hooks/useAtCompletion.ts:154-156`.
- Auth selection reset in integration test: `selectedType: ''` in `integration-tests/json-output.test.ts:44`.
- MCP test type fixes using `vi.importActual`: `packages/core/src/tools/mcp-client-manager.test.ts:15-22`.
- MCP command structure still includes tips and list/auth/refresh subcommands: `packages/cli/src/ui/commands/mcpCommand.ts:329-338` (tips) and `packages/cli/src/ui/commands/mcpCommand.ts:485-568` (list/auth/refresh subcommands).
- No `McpStatus.tsx` file present (glob search returned none).

## Gaps/Mismatches
- PROGRESS.md claims “McpStatus.tsx deleted (as expected)” and subcommands list/desc/schema, but the repo has no McpStatus.tsx to delete and the MCP command defines list/auth/refresh with desc/schema handled as list flags, not subcommands (`packages/cli/src/ui/commands/mcpCommand.ts:485-568`).
- PROGRESS.md implies “Remove MCP Tips,” but tips are still emitted when no arguments are passed (`packages/cli/src/ui/commands/mcpCommand.ts:329-338`).

## Verdict
partial
