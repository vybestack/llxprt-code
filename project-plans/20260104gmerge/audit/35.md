# Batch 35 Audit

## Planned
- Upstream `49bde9fc` fixes GCS task store path handling in the A2A server.
- Upstream `61a71c4f` removes a custom `waitFor` helper in tests.
- Upstream `d5a06d3c` fixes gitignore parsing for trailing spaces.

## Reported
- `project-plans/20260104gmerge/AUDIT.md` marks `49bde9fc` as VERIFIED with local commit `fffbb87ee`, describing GCS path handling plus tests added.
- `project-plans/20260104gmerge/AUDIT.md` marks `61a71c4f` as SKIP due to LLxprt requiring a custom `waitFor` for ink tests (batch noted as 2 of 3 applied).
- `project-plans/20260104gmerge/AUDIT.md` marks `d5a06d3c` as VERIFIED with local commit `019f9daba`, describing trailing-space gitignore behavior.

## Actual (evidence)
- GCS task store path validation is implemented: `packages/a2a-server/src/persistence/gcs.ts:87` checks `isTaskIdValid` before building object paths and throws on invalid task IDs; this blocks path traversal before `tasks/${taskId}/...` is built.
- GCS path handling is covered by tests: `packages/a2a-server/src/persistence/gcs.test.ts:231` asserts that a task id like `../../../malicious-task` is rejected during `save`.
- Custom test `waitFor` remains in place: `packages/cli/src/ui/components/SettingsDialog.test.tsx:137` defines a local `waitFor` helper with polling and timeout, indicating the upstream removal was not applied.
- Trailing-space gitignore handling exists in parser/tests: `packages/core/src/utils/gitIgnoreParser.ts:114` trims leading whitespace and preserves escaped trailing space patterns, and `packages/core/src/utils/gitIgnoreParser.test.ts:303` verifies `foo\ ` matches `foo ` while unescaped trailing spaces are treated as insignificant.

## Gaps
- `61a71c4f` upstream behavior (removing custom `waitFor`) is not implemented; LLxprt still relies on a custom `waitFor` in ink-based tests, so the skip aligns with current architecture.
- No gaps found for `49bde9fc` or `d5a06d3c`.

## Confidence
- High for `49bde9fc` and `d5a06d3c` because both code and tests exist in the repo.
- Medium for `61a71c4f` because only the local `waitFor` helper evidence is checked (not all tests surveyed).
