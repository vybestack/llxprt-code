# Reimplement Plan: Shell Inactivity Timeout

**Upstream SHA:** `0d29385e1bdf0f73e663df490a1b88ed3117ae16`
**Batch:** 6

## What upstream does

Adds a configurable inactivity timeout that resets on every output event, separate from total execution timeout. Detects hung commands waiting for input.

## LLxprt approach

Implement the same behavior but control via `/set` ephemeral or `/setting` rather than static config. Preserve existing `timeout_seconds` as total timeout.

## Files to modify

1. `packages/core/src/tools/shell.ts` — add `inactivityTimeout` parameter
2. `packages/core/src/services/shellExecutionService.ts` — implement reset-on-output timer
3. `packages/core/src/config/config.ts` — add `getShellToolInactivityTimeout()` getter
4. `packages/cli/src/config/settingsSchema.ts` — add setting
5. `schemas/settings.schema.json` — add schema entry
6. Tests for both timeout types (total + inactivity)

## Key design

- Inactivity timer starts when command begins
- Every `ShellOutputEvent` resets the timer
- If timer fires, abort the command (same as total timeout)
- Default: 120s (configurable)
- Combined with total timeout via `AbortSignal.any()`

## Verification

- Unit tests: timer resets on output, fires on silence
- Integration: verify `gh pr checks --watch` does NOT trigger (produces output)
