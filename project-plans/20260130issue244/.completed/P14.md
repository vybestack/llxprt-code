# Phase 14 Completed

Phase: P14 - Implement CheckAsyncTasksTool
Completed: 2026-01-29

## Deliverables
- Added @plan PLAN-20260130-ASYNCTASK.P14 marker
- Full implementation in `packages/core/src/tools/check-async-tasks.ts`:
  - **execute()**: Routes to executeList or executePeek based on task_id param
  - **executeList()**: 
    - Returns summary with counts by status (running/completed/failed/cancelled)
    - Shows task details with status icons, ID prefix, subagent name, duration
    - Returns "no tasks" message when empty
  - **executePeek()**:
    - Tries exact ID match first
    - Falls back to prefix match via AsyncTaskManager.getTaskByPrefix
    - Handles ambiguous prefix with candidate list (11 chars + "...")
    - Returns appropriate error for not found
  - **formatTaskDetails()**:
    - Returns full JSON with all task fields
    - Includes emitted_vars from output if present
    - Formats display with markdown
  - **formatDuration()**:
    - Seconds: "15s"
    - Minutes: "2m 30s"
    - Hours: "1h 15m"
  - **formatTaskDisplay()**:
    - Markdown formatted display
    - Truncates emitted_vars values to 50 chars
    - Shows goal prompt truncated to 100 chars
- Follows pseudocode exactly (lines 60-242)
- Uses ToolErrorType.INVALID_TOOL_PARAMS for errors

## Verification
- [OK] All 10 tests pass
- [OK] Core package typechecks successfully
- [OK] Implementation matches pseudocode requirements
- [OK] Error handling follows tool-error.ts patterns
- [OK] Duration formatting works correctly for all time ranges
- [OK] Prefix matching shows 11 chars + "..." for disambiguation
